<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>App</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_App.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">App</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module contains methods for requesting <code>GIOS</code> API and
  mechanisms for retrieving eligible data.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:WithAssets">WithAssets</a> = <a href="Api.html#t:Api">Api</a> :&lt;|&gt; Raw</li><li class="src short"><a href="#v:withAssets">withAssets</a> :: Proxy <a href="App.html#t:WithAssets">WithAssets</a></li><li class="src short"><a href="#v:app">app</a> :: IO Application</li><li class="src short"><a href="#v:server">server</a> :: IO (Server <a href="App.html#t:WithAssets">WithAssets</a>)</li><li class="src short"><a href="#v:apiServer">apiServer</a> :: <a href="App.html#t:DB">DB</a> -&gt; Server <a href="Api.html#t:Api">Api</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:DB">DB</a> = <a href="#v:DB">DB</a> (MVar (Map Int <a href="Table.html#t:Table">Table</a>))</li><li class="src short"><a href="#v:process">process</a> :: Int -&gt; <a href="App.html#t:DB">DB</a> -&gt; IO <a href="Table.html#t:Table">Table</a></li><li class="src short"><a href="#v:getTimeDiff">getTimeDiff</a> :: String -&gt; IO Double</li><li class="src short"><a href="#v:generateTable">generateTable</a> :: Int -&gt; IO <a href="Table.html#t:Table">Table</a></li><li class="src short"><a href="#v:generateStation">generateStation</a> :: Int -&gt; IO <a href="Station.html#t:Station">Station</a></li><li class="src short"><a href="#v:generateAvg">generateAvg</a> :: Int -&gt; IO [Double]</li><li class="src short"><a href="#v:getSensorIds">getSensorIds</a> :: Int -&gt; IO [String]</li><li class="src short"><a href="#v:getAvgFromUrl">getAvgFromUrl</a> :: String -&gt; IO Double</li><li class="src short"><a href="#v:getValues">getValues</a> :: String -&gt; IO [<a href="Survey.html#t:Survey">Survey</a>]</li><li class="src short"><a href="#v:computeAvg">computeAvg</a> :: [<a href="Survey.html#t:Survey">Survey</a>] -&gt; Double</li><li class="src short"><a href="#v:unwrapDouble">unwrapDouble</a> :: Maybe Double -&gt; Double</li><li class="src short"><a href="#v:unwrapTime">unwrapTime</a> :: Maybe String -&gt; String</li><li class="src short"><a href="#v:getLevelName">getLevelName</a> :: IO <a href="Station.html#t:Station">Station</a> -&gt; (<a href="Station.html#t:Station">Station</a> -&gt; Maybe <a href="Index.html#t:Index">Index</a>) -&gt; IO String</li><li class="src short"><a href="#v:createTable">createTable</a> :: IO <a href="Station.html#t:Station">Station</a> -&gt; [Double] -&gt; IO <a href="Table.html#t:Table">Table</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:WithAssets" class="def">WithAssets</a> = <a href="Api.html#t:Api">Api</a> :&lt;|&gt; Raw <a href="#t:WithAssets" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:withAssets" class="def">withAssets</a> :: Proxy <a href="App.html#t:WithAssets">WithAssets</a> <a href="#v:withAssets" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:app" class="def">app</a> :: IO Application <a href="#v:app" class="selflink">#</a></p><div class="doc"><p>Returns application instance.</p></div></div><div class="top"><p class="src"><a id="v:server" class="def">server</a> :: IO (Server <a href="App.html#t:WithAssets">WithAssets</a>) <a href="#v:server" class="selflink">#</a></p><div class="doc"><p>Creates instance of a server.</p></div></div><div class="top"><p class="src"><a id="v:apiServer" class="def">apiServer</a> :: <a href="App.html#t:DB">DB</a> -&gt; Server <a href="Api.html#t:Api">Api</a> <a href="#v:apiServer" class="selflink">#</a></p><div class="doc"><p>Returns api routing for allowed requests.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DB" class="def">DB</a> <a href="#t:DB" class="selflink">#</a></p><div class="doc"><p>Scheme of fake database</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DB" class="def">DB</a> (MVar (Map Int <a href="Table.html#t:Table">Table</a>))</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:process" class="def">process</a> <a href="#v:process" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>Index of table</p></td></tr><tr><td class="src">-&gt; <a href="App.html#t:DB">DB</a></td><td class="doc"><p>Instance of fake db</p></td></tr><tr><td class="src">-&gt; IO <a href="Table.html#t:Table">Table</a></td><td class="doc"><p>Returns desired table</p></td></tr></table></div><div class="doc"><p>Main method for retrieving table.</p></div></div><div class="top"><p class="src"><a id="v:getTimeDiff" class="def">getTimeDiff</a> :: String -&gt; IO Double <a href="#v:getTimeDiff" class="selflink">#</a></p><div class="doc"><p>Computes difference between given time (as string) and current time.</p></div></div><div class="top"><p class="src"><a id="v:generateTable" class="def">generateTable</a> :: Int -&gt; IO <a href="Table.html#t:Table">Table</a> <a href="#v:generateTable" class="selflink">#</a></p><div class="doc"><p>Generates new table if desired table does not exist or has expired.</p></div></div><div class="top"><p class="src"><a id="v:generateStation" class="def">generateStation</a> :: Int -&gt; IO <a href="Station.html#t:Station">Station</a> <a href="#v:generateStation" class="selflink">#</a></p><div class="doc"><p>Returns instance of station data from <code>GIOS</code> API.</p></div></div><div class="top"><p class="src"><a id="v:generateAvg" class="def">generateAvg</a> :: Int -&gt; IO [Double] <a href="#v:generateAvg" class="selflink">#</a></p><div class="doc"><p>Computes average pollution value from last 24 surveys for each compound.</p></div></div><div class="top"><p class="src"><a id="v:getSensorIds" class="def">getSensorIds</a> :: Int -&gt; IO [String] <a href="#v:getSensorIds" class="selflink">#</a></p><div class="doc"><p>Returns indexes of sensors for given station.</p></div></div><div class="top"><p class="src"><a id="v:getAvgFromUrl" class="def">getAvgFromUrl</a> :: String -&gt; IO Double <a href="#v:getAvgFromUrl" class="selflink">#</a></p><div class="doc"><p>Returns average pollution value for given URL.</p></div></div><div class="top"><p class="src"><a id="v:getValues" class="def">getValues</a> :: String -&gt; IO [<a href="Survey.html#t:Survey">Survey</a>] <a href="#v:getValues" class="selflink">#</a></p><div class="doc"><p>Handles requesting <code>GIOS</code> API for given sensor URL.</p></div></div><div class="top"><p class="src"><a id="v:computeAvg" class="def">computeAvg</a> :: [<a href="Survey.html#t:Survey">Survey</a>] -&gt; Double <a href="#v:computeAvg" class="selflink">#</a></p><div class="doc"><p>Computes average pollution value for given array of values.</p></div></div><div class="top"><p class="src"><a id="v:unwrapDouble" class="def">unwrapDouble</a> :: Maybe Double -&gt; Double <a href="#v:unwrapDouble" class="selflink">#</a></p><div class="doc"><p>Unwraps double type.</p></div></div><div class="top"><p class="src"><a id="v:unwrapTime" class="def">unwrapTime</a> :: Maybe String -&gt; String <a href="#v:unwrapTime" class="selflink">#</a></p><div class="doc"><p>Unwraps time value.</p></div></div><div class="top"><p class="src"><a id="v:getLevelName" class="def">getLevelName</a> <a href="#v:getLevelName" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: IO <a href="Station.html#t:Station">Station</a></td><td class="doc"><p>Wrapped station</p></td></tr><tr><td class="src">-&gt; (<a href="Station.html#t:Station">Station</a> -&gt; Maybe <a href="Index.html#t:Index">Index</a>)</td><td class="doc"><p>Retrieving field from data Station</p></td></tr><tr><td class="src">-&gt; IO String</td><td class="doc"><p>Retrieved index value name</p></td></tr></table></div><div class="doc"><p>Retrieves index value name for given field.</p></div></div><div class="top"><p class="src"><a id="v:createTable" class="def">createTable</a> <a href="#v:createTable" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: IO <a href="Station.html#t:Station">Station</a></td><td class="doc"><p>Instance of Station data</p></td></tr><tr><td class="src">-&gt; [Double]</td><td class="doc"><p>Array of average pollution values</p></td></tr><tr><td class="src">-&gt; IO <a href="Table.html#t:Table">Table</a></td><td class="doc"><p>Wrapped Table data instance</p></td></tr></table></div><div class="doc"><p>Returns new instance of Table data.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>